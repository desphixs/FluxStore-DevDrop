<!-- Product Card (keeps data-attrs and class hooks) -->
<div class="group relative flex flex-col overflow-hidden rounded-2xl border border-gray-200 bg-white transition-all duration-300 hover:-translate-y-[2px] shadow-sm hover:shadow-lg">
  {% if p.primary_item.label %}
    <span class="absolute left-3 top-3 rounded-md {{p.primary_item.label_color}} px-2.5 py-1 text-xs font-semibold text-white">
      {{p.primary_item.label}}
    </span>
  {% endif %}

  {% if p.primary_item.show_discount_type == "price" %}
    <span class="absolute left-3 top-10 rounded-md bg-black px-2.5 py-1 text-[11px] font-semibold text-white">
      {{site_config.currency_abbr}}{{p.primary_item.discount_amount|floatformat:0}} OFF
    </span>
  {% endif %}

  {% if p.primary_item.show_discount_type == "percentage" %}
    <span class="absolute left-3 top-10 rounded-md bg-black px-2.5 py-1 text-[11px] font-semibold text-white">
      {{p.primary_item.discount_amount|floatformat:0}}% OFF
    </span>
  {% endif %}

  <a href="{% url 'store:product_detail' p.slug %}" class="block">
    <img
      src="{{p.primary_image.image.url}}"
      alt="{{p.name}}"
      class="h-[16rem] w-full object-contain p-4 transition-transform duration-500 group-hover:scale-[1.02]"
    />
  </a>

  <div class="p-4">
    <p class="text-[11px] text-gray-500"><a href="">{{p.category.name}}</a></p>
    <h3 class="mt-1 mb-2 text-sm font-semibold text-gray-900 leading-snug">
      <a href="{% url 'store:product_detail' p.slug %}" class="hover:underline">{{p.name}}</a>
    </h3>

    <div class="mb-2 flex items-center text-xs">
      <span class="text-black">
        {% for i in "12345" %}{% if forloop.counter <= p.average_rating_int %}★{% else %}☆{% endif %}{% endfor %}
      </span>
      <span class="ml-1 text-gray-500">({{p.average_rating_int}})</span>
    </div>

    <p class="text-xs text-gray-500">By: {{p.vendor.vendor_profile.business_name}}</p>

    <div class="mt-4 flex items-center justify-between">
      <div>
        <span class="text-lg font-bold text-gray-900">{{site_config.currency_abbr}}{{p.primary_item.sale_price}}</span>
        {% if p.primary_item.show_regular_price %}
          <span class="text-sm text-gray-400 line-through ml-2">
            {{site_config.currency_abbr}}{{p.primary_item.regular_price}}
          </span>
        {% endif %}
      </div>

      <!-- keep class & data attrs for your cart logic -->
      <button
        data-product-id="{{ p.id }}"
        data-variation-id="{{ p.primary_item.id }}"
        class="add-to-cart rounded-full bg-black px-4 py-2 text-xs font-semibold text-white transition hover:opacity-90 focus:outline-none focus-visible:ring-2 focus-visible:ring-black/30"
      >
        ＋ Add
      </button>
    </div>
  </div>
</div>
